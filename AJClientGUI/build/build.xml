<?xml version="1.0"?>
<!DOCTYPE project []>
<project name="aj_java_gui" default="help" basedir="..">

   <taskdef name="pack" classname="org.sadun.util.ant.Pack" classpath="${basedir}/tools/pack.jar"/>

   <!-- component directories ... -->
   <property name="gui.srcdir"      location="${basedir}/src"/>
   <property name="gui.compiledir"  location="${basedir}/classes"/>

   <!-- other path settings, some items to be customized locally ...  -->
   <property name="xercesImpl.jar"            location="${basedir}/tools/xercesImpl.jar"/>
   <property name="xml-apis.jar"            location="${basedir}/tools/xml-apis.jar"/>
   <property name="log4j-1.2.8.jar"            location="${basedir}/needed_jars/log4j-1.2.8.jar"/>
   <property name="skinlf.jar"            location="${basedir}/needed_jars/skinlf.jar"/>
   <property name="ajcorefassade.jar"            location="${basedir}/needed_jars/ajcorefassade.jar"/>

   <!-- classpath for compilation ... -->
   <path id="lib.path">
      <pathelement location="${xercesImpl.jar}"/>
      <pathelement location="${xml-apis.jar}"/>
      <pathelement location="${log4j-1.2.8.jar}"/>
      <pathelement location="${skinlf.jar}"/>
      <pathelement location="${ajcorefassade.jar}"/>
   </path>

   <!-- remove class files, DavaDoc files and test results ... -->
   <target name="gui-clean" description="deletes class files">
      <delete includeEmptyDirs="true">
         <fileset dir="${gui.compiledir}" casesensitive="false">
            <include name="**/*.class"/>
            <exclude name="cvs"/>
            <exclude name="readme.txt"/>
            </fileset>
      </delete>
   </target>

   <target name="help"/>

   <target name="gui-compile" description="compiles the appleJuice-gui">
      <mkdir dir="${gui.compiledir}"/>
      <javac srcdir="${gui.srcdir}" destdir="${gui.compiledir}" debug="true">
         <classpath>
          <path refid="lib.path"/>
         </classpath>
      </javac>
   </target>

   <target name="gui-rebuild" depends="gui-clean, gui-compile" description="cleans and compiles the appleJuice-gui">
   </target>

   <target name="create-jar" depends="gui-compile" description="builds appleJuice-jar">
	<pack classes="de.applejuicenet.client.AppleJuiceClient,org.apache.xerces.parsers.XML11Configuration,
			org.apache.xerces.impl.dv.dtd.DTDDVFactoryImpl,org.apache.xerces.parsers.IntegratedParserConfiguration"
	      targetJar="${basedir}/AJCoreGUI.jar"
	      excludePkg="java,javax,sun,com.l2fprod,com.sixlegs,org.apache.log4j"
              manifestClassPath="./needed_jars/log4j-1.2.8.jar ./needed_jars/skinlf.jar ./needed_jars/looks-1.2.1.jar"
	      manifestMainClass="de.applejuicenet.client.AppleJuiceClient">
           <classpath>
           	<pathelement path="${gui.compiledir}"/>
           	<path refid="lib.path"/>
           </classpath>
	   <additionalclass name="org.apache.xerces.parsers.SAXParser"/>
           <additionalfileset dir="${gui.compiledir}" excludes="**/*.txt **/*.class **/*.dep2"/>
	</pack>
   </target>

   <target name="build-archive" depends="create-jar" description="builds archive-zip">
	<jar destfile="${basedir}/AJCoreGUI_vX_XX.zip">
		<fileset dir="${basedir}" includes="AJCoreGUI.jar"/>
		<fileset dir="${basedir}" includes="AJCoreGUI.exe"/>
		<fileset dir="${basedir}" includes="wizard.xml"/>
		<fileset dir="${basedir}" includes="changelog.htm"/>
		<fileset dir="${basedir}" includes="TrayIcon12.dll"/>
		<fileset dir="${basedir}" includes="language/*.xml language/*.gif"/>
		<fileset dir="${basedir}" includes="icons/*.gif icons/*.properties"/>
		<fileset dir="${basedir}" includes="plugins/*.jar plugins/*.gif plugins/*.txt"/>
		<fileset dir="${basedir}" includes="pwdlpolicies/*.jar pwdlpolicies/*.txt"/>
		<fileset dir="${basedir}" includes="themes/*.zip themes/*.first"/>
		<fileset dir="${basedir}" includes="sounds/*.wav sounds/*.first"/>
		<fileset dir="${basedir}" includes="needed_jars/*.jar"/>
         </jar>
   </target>

   <target name="build-plugin-jar" description="builds plugin - build.xml needs to be modified">
      <delete includeEmptyDirs="true">
         <fileset dir="${basedir}/plugins" casesensitive="false">
            <include name="**/IrcPlugin.jar"/>
         </fileset>
      </delete>
	  <jar destfile="${basedir}/plugins/IrcPlugin.jar">
		<fileset dir="${basedir}/plugin_src/ircplugin" includes="*.xml"/>
		<fileset dir="${basedir}/classes" includes="**/de/applejuicenet/client/gui/plugins/**/*.*"
                excludes="**/de/applejuicenet/client/gui/plugins/PluginConnector.class
                        ,**/de/applejuicenet/client/gui/plugins/XMLValueHolder.class" />
      </jar>
	  <jar destfile="${basedir}/plugins/IrcPlugin.zip">
		<fileset dir="${basedir}/plugins/" includes="IrcPlugin.jar"/>
		<fileset dir="${basedir}/plugin_src/ircplugin/icons/" includes="*.gif"/>
      </jar>
   </target>

   <target name="build-pwdlPolicy-jar" description="builds pwdlPolicy - build.xml needs to be modified">
      <delete includeEmptyDirs="true">
         <fileset dir="${basedir}/pwdlpolicies" casesensitive="false">
            <include name="**/StandardPwdlPolicy.jar"/>
         </fileset>
      </delete>
	<jar destfile="${basedir}/pwdlpolicies/StandardPwdlPolicy.jar">
		<fileset dir="${basedir}/classes" includes="**/de/applejuicenet/client/gui/powerdownload/**/*.*"
			excludes="**/de/applejuicenet/client/gui/powerdownload/AutomaticPowerdownloadPolicy.class" />
         </jar>
   </target>

   <target name="cruisecontrol" description="target for cruisecontrol">
      <cvs dest="${basedir}" command="update -d -P"/>
      <antcall target="gui-rebuild"/>
   </target>

   <target name="complete" depends="create-jar" description="builds complete appleJuice">
   </target>
</project>
